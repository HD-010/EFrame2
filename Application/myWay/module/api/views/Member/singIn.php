<div class="container" >

	<!-- ## START header ## -->
	
        <div style="text-align:center">
            <div class="header-new">



            			<div class="fkw-topbar-box">
            				<a class="fkw-logo" target="_blank"  title='点击可打开凡科网' href='http://www.fkw.com'></a>
            				<div class="f-topbar-right">
            					<a class="slogan"  style="display:inline-block" biz="none" target="_blank"  title='点击可打开凡科网' href='http://www.fkw.com'>
            						<i></i><font>凡科上市“新三板”股票代码：832828</font>
            					</a>
            					<a class="slogan" biz="site" target="_blank" title='点击可打开凡科建站官网' href='http://" +jz.fkw.com+"'>
            						<i></i><font>一次注册=电脑网站+手机网站+微信网站</font>
            					</a>
            					<a class="slogan" biz="flyer" target="_blank" title='点击可打开微传单官网' href='http://" + wcd.im+"'>
            						<i></i><font>高逼格H5、邀请函、招聘贴</font>
            					</a>
            					<a class="slogan" biz="hd" target="_blank" title='点击可打开凡科互动官网' href='http://" +hd.fkw.com +"'>
            						<i></i><font>吸粉/抽奖/互动/引流，一步到位</font>
            					</a>
            					<a class="slogan" biz="wxast" target="_blank" title="点击可打开公众号助手官网" href="http://mp.faisco.com">
            						<i></i><font>微网站/微商城/微传单，一应俱全</font>
            					</a>
            					<a class="slogan" biz="program" target="_blank" title='点击可打开凡科小程序官网' href='http://qz.fkw.com'>
            						<i></i><font>拖拽式，3分钟制作专属小程序</font>
            					</a>
            					<a class="slogan" biz="ktu" target="_blank" title='点击可打开凡科快图官网' href='http://" + kt.fkw.com +"'>
            						<i></i><font>不用PS在线做图片</font>
            					</a>
            				</div>
            			</div>



            		</div>
    	
	<!-- ## END header ## -->

	<!-- ## START middle ## -->
	

	    <div class="textLine">
    		<span>注册用户</span>
    		<span class="number">16,741,366<span class="font12">+</span></span>
    		<span class="sep"></span>
    		<span>安全运行</span>
    		<span class="number">2894<span class="font12">天+</span></span>
    		<span class="sep"></span>
    		<span>覆盖行业</span>
    		<span class="number">100<span class="font12">+</span></span>
    	</div>
    	<div class="login-new">
            <div class="blueLine"></div>
            <div class="login-type-check">
                <div class="check-type1">密码登录</div>
                <div class="check-type2" id="check-type2">短信码登录</div>
            </div>
            <div class="login-type-line">
                 <div class="check-line1"></div>
                 <div class="check-line2"></div>
            </div>
            <input type="text" style="display:none" value="0" id="select-table"/>




            <div class="box-a" style="margin:0;padding:0;">
            <div class="new-card">
                <div class="new-card1">帐号</div>
                <div class="new-card2">
                    	<input type="text" id="log-cacct-new" placeholder="请输入帐号\邮箱\手机号码" autocomplete="off" maxlength="34">
                </div>
                <div class="new-card3"></div>
            </div>

            <div class="new-employee" style="display:none">
                <div class="new-employee1">员工</div>
                <div class="new-employee2">
                      <input type="text" placeholder="请输入员工帐号" id="log-sacct-new" autocomplete="off" maxlength="34">
                </div>
                <div class="new-employee3"></div>
            </div>
            <div class="new-password">
                <div class="new-password1">密码</div>
                <div class="new-password2">
                      <input type="password" id="log-pwd-new" placeholder="请输入密码" name="new-password" autocomplete="off" maxlength="34">
                 </div>
                <div class="new-password3"> </div>
            </div>

            <!--<div id="log-valid-line" class="log-line" style="display:none;left: 295px;margin-top: -23px;margin-bottom: 21px">
            	<div class="log-txt" style="width:116px; left:-12px;">验证码</div>
            	<input id="log-valid" type="text" class="log-input input2" style="width:159px; padding-left:12px;left:-31px" />
            	<img id="log-valid-img" title="看不清？点击换一张" />
            	<span id="log-refresh-btn" title="看不清？点击换一张"></span>
            </div>-->

            <input type='text' id='log-valid' style='display:none'/>
            <div class="new-checkbox">
                  <div class="new-checkbox-div1"><input type="checkbox" id="staff-login" name="login-by-employee"/><i>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp使用员工帐号登录</i></div>
                  <div class="new-checkbox-div2"><input type="checkbox" id="auto-login" name="login-two-weeks"/><i>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp两周内自动登录</i></div>
                  <div class="new-checkbox-div-a1"></div>
                  <div class="new-checkbox-div-a2"></div>
            </div>
            </div>



                    <div class="box-b" style="margin:0;padding:0;display:none">
                        <div class="new-card-b">
                            <div class="new-card1-b">手机号</div>
                            <div class="new-card2-b">
                                	<input type="text" id="log-mobile-new" placeholder="请输入手机号码"  maxlength="34">
                            </div>
                            <div class="new-card3-b"></div>
                        </div>

                        <div class="new-xin">
                            <div class="new-xin1">短信码</div>
                            <div class="new-xin2">
                                  <input type="text" id="log-mobileCode-new" placeholder="请输入短信码" autocomplete="off" maxlength=6>
                            </div>
                            <button class="new-button" disabled="disabled">获取短信码</button>
                        </div>

                        <div id="codeLogin-valid-line" class="log-line" style="display:none;">
                        	<div class="log-txt" style="width:116px; left:12px;">验证码</div>
                        	<input id="codeLogin-valid" type="text" class="log-input input2" style="width:116px; padding-left:12px;" />
                        	<img id="codeLogin-valid-img" title="看不清？点击换一张" />
                        	<span id="codeLogin-refresh-btn" title="看不清？点击换一张"></span>
                        </div>


                     </div>



            <div id="error" class="worn-new"></div>
            <div class="bottomBar">
            	<font class="msg" id="regMsg"></font>
            	<button class="u-bigBtn" id="login-button-new">登&nbsp;&nbsp;&nbsp;&nbsp;&nbsp录</button>
            </div>
            <div class="new-linked1">
                <div>未有帐号？<a href="/api/member/sing_Up" class="spec-a">立即注册</a></div>
                <a style="position: relative;left: -91px;text-decoration: none;" href="javascript:;" onClick="openPassword();">忘记密码？</a>
            </div>
            <div class="new-linked2">
            ———&nbsp;&nbsp;&nbsp; 第三方帐号登录 &nbsp;&nbsp;&nbsp;———
            </div>
            <div class="new-linked3">
                <a class="login_WeChatI-new" href="javascript:;" onclick="bindWeChat();" title="微信登录"></a>
                <a class="login_QQI-new" href="javascript:;" onclick="bindQQAccount();" title="QQ登录"></a>
            </div>
    	</div>

	
	<!-- ## END middle ## -->
	<!-- </div> -->



</div>

	
    	<div class="m-wave">
    		<ul class="wave-item item1">
    			<li class="wave-bg wave-bg1"></li>
    			<li class="wave-bg wave-bg1"></li>
    		</ul>
    		<ul class="wave-item item2">
    			<li class="wave-bg wave-bg2"></li>
    			<li class="wave-bg wave-bg2"></li>
    		</ul>
    		<ul class="wave-item item3">
    			<li class="wave-bg wave-bg3"></li>
    			<li class="wave-bg wave-bg3"></li>
    		</ul>
    		<div class="footer-new">
    			<img src="//ps.faisys.com/image/beianIcon.png" width="20" height="20" style="margin-left:0px;">
    			粤公网安备 44010502000715号 | Copyright &copy; 2010-2018 广州凡科互联网科技股份有限公司 粤ICP备10235580号
    			<a target="_blank" hidefocus="true" href="http://www.itrust.org.cn/Home/Index/itrust_certifi?wm=1639937559" class="fk-trustLink1"></a>
    			<a class="fk-trustLink2" href='https://credit.szfw.org/CX20180326037663800199.html' target='_blank'></a>
    			<a href="https://ss.knet.cn/verifyseal.dll?sn=e17030244010066816266j000000&pa=111332 " tabindex="-1" class="fk-trustLink3" target="_blank"></a>
    		</div>
    	</div>

    	
</div>
<div style="clear:both"></div>

<script type="text/x-template" id="t-imgVerify">


	<div class="m-imgVerify">
		<span class="close"></span>
		<div class="title">请先完成下方验证</div>
		<div class="inputLine">
			<input type="text" maxlength="4" class="codeVal" placeholder="请输入右侧验证码"><!--
			--><img class="codeImg">
			<span class="refreshBtn">换一张</span>
		</div>
		<div class="msg"></div>
		<button class="u-bigBtn confirmBtn">确定</button>
	</div>


</script>
<script type="text/javascript">

var faiEncrypt_key = "MIGfMA0GCSqGSxx3DQEBAQUAA4GNADCBiQKBgQCBWNoG5LJ3u44Gs8PWs1MaNUQQ+mOmh+9zWdzSt3ORbmfCDvU+ssW/6QTTgXvWWx7+Wzq/a4fCCQp72zSqXeVhWkTVct9Hyp/iMo5K6qOEK76z9z+tP/u99X6qazeXGVMWKkPiyZT4mKAGd/U8Mph9Z1Z5kOluA7g7heq8PPlE9wIDAQAB";



    /* 波浪动画模块 */
		var mWave = (function(){
			var $dom = $('.m-wave');

			function init(){
				start($dom.find('.wave-item.item1'), 150000);
				start($dom.find('.wave-item.item2'), 140000);
				start($dom.find('.wave-item.item3'), 30000);
			}
			function start($target, speed){
				var halfWidth = parseInt($target.width() / 2);
				$target.animate({'marginLeft': - halfWidth + 'px'}, speed, 'linear', roll);
				function roll(){
					$target.css('marginLeft', 0);
					$target.animate({'marginLeft': - halfWidth + 'px'}, speed, 'linear', roll);
				}
			}
			return {
				init: init
			}
		})();
		/* 波浪动画模块 end */

function isMobile(mobile){
	var pattern = /^1[3456789]\d{9}$/;
	return pattern.test(mobile);
}
var cacct = "";
var sacct = "";







////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////








    var needValidateCode=false;


$(function(){

        //新页面判断底部波浪动画初始化
        
            mWave.init();
        
		login.initEvent();
        var logAcct = $('#log-cacct-new'), logAcctVal;
		//从url/cookie中获取用户名
		if (cacct.length > 0) {
			logAcctVal = cacct;
		}else{
			logAcctVal = $.cookie('loginCacct');
		}

		//判断是我们内部员工的帐号还是邮箱或者手机
		if(logAcctVal != null && $.trim(logAcctVal) != ''){
			if(!isMobile(logAcctVal) && !Fai.isEmail(logAcctVal)){
				var logSacct = $('#log-sacct-new');
				var logSacctVal = $.cookie('loginSacct');
				var logUseSacct = $.cookie('loginUseSacct');
				if (sacct.length > 0) {
					logSacctVal = sacct;
				}
				if(logSacctVal) {
					logSacct.val(logSacctVal);
				}
				if(logUseSacct == 1) {
				    $(".new-checkbox-div-a1").click(); //点击切换到员工登录
				    $(".login-new").attr('height','617px');
				}else{
				    $(".login-new").attr('height','539px');
				}
			}
			logAcct.val(logAcctVal);
			checkCacctLoginByPwd(logAcctVal);
		}
		//原来手机和邮箱存的cookie是loginAcct，这里过渡一下，过一段时间可以直接删掉
		else{
			logAcctVal = $.cookie('loginAcct');
			if(logAcctVal != null && $.trim(logAcctVal) != ''){
				logAcct.val(logAcctVal);
				checkCacctLoginByPwd(logAcctVal);
			}
		}
		$.cookie('loginAcct', null, {path:'/', domain:'fkw.com'});

		


		//IE(除了IE11)，底层的灰色提示标签会被触发focus，反而顶层输入框获取不到焦点，这里特殊处理转移焦点
		//因为IE给元素设置了绝对定位和z-index，若顶层元素是透明而底层元素非透明，还是会默认底层非透明的元素在上层（可以给底层输入框加背景颜色试试就知，加了不做以下的焦点转移也可以正常获取焦点）
//		if($.browser.msie){
//		if(Fai.isIE()){
//			$('.log-line .log-txt').click(function(){
//				$(this).siblings('.log-input').focus();
//			});
//		}
//		if ( Fai.isIE7() || Fai.isIE8()){	//IE7/8隐藏我们自定义的checkbox样式，会错位
//			$('.goin .checkItemLabel').hide();
//		}

		checkFocus( 'log-cacct-new' );
		checkFocus( 'log-sacct-new' );
		checkFocus( 'log-pwd-new' );
		checkFocus( 'log-valid' );

		setTimeout(autoFocus, 50);
	});

    /*员工、用户登录选择切换*/
    $(".new-checkbox-div-a1").click(function(){
        var dis=$(".new-employee").css("display");
        if("none"==dis){
            $(".new-employee").css("display","block");
            $(".new-card2 input[type='text']").attr("placeholder","请输入帐号");
            $(".new-card2 input[type='text']").focus();
            $(".new-checkbox-div-a1").css("backgroundPosition","-84px -142px");
            $(".login-new").css("height","617px");
            if($("#error").css('display')!='none'){
                $(".login-new").height(($('.login-new').height())+($('#error').outerHeight(true)));
            }
            $(".new-checkbox-div1 input[name='login-by-employee']").prop("checked",true);

        }else{
            $(".new-employee").css("display","none");
            $(".new-card2 input[type='text']").attr("placeholder","请输入帐号\\邮箱\\手机号码");
            $(".new-card2 input[type='text']").focus();
            $(".new-checkbox-div-a1").css("backgroundPosition","-84px -175px");
            $(".login-new").css("height","539px");
            if($("#error").css('display')!='none'){
                $(".login-new").height(($('.login-new').height())+($('#error').outerHeight(true)));
            }
            $(".new-checkbox-div1 input[name='login-by-employee']").prop("checked",false);

        }
    })

     /*登录两周缓存*/
        $(".new-checkbox-div-a2").click(function(){
            var che=$(".new-checkbox-div2 input[name='login-two-weeks']").is(':checked');
            if(che==true){
                $(".new-checkbox-div-a2").css("backgroundPosition","-84px -175px")
                $(".new-checkbox-div2 input[name='login-two-weeks']").prop("checked",false);
            }else{
                $(".new-checkbox-div-a2").css("backgroundPosition","-84px -144px")
                $(".new-checkbox-div2 input[name='login-two-weeks']").prop("checked",true);
            }
        })


       $("#log-valid").focus(function(){
            $(this).prev().css("display","none")
       }).blur(function(){
        if($("#log-valid").val().length<=0){
            $(this).prev().css("display","")
        };
       })



	//自动获取输入框焦点
	function autoFocus(){
		$('#log-cacct-new, #log-sacct-new, #log-pwd-new').filter(':visible').each(function(){
			var $this = $(this);
			if($this.val() == ''){
				$this.focus();
				checkFocus($this.attr('id'));
				return false;
			}
		});
	}


	function checkCacctLoginByPwd(cacct){
	    if(checkCacctNewJs(cacct)==1){
	      $.ajax({
          	type: 'post',
            url: '/ajax/reg_h.jsp?cmd=checkCacctForPwd&cacct='+cacct+'&acctType=1',
            success:function(result){
                var data=$.parseJSON( result );
                if(data){
                    if(data.success){
                        if(data.rt==-80){
                           showMsg("帐号未设置密码，请使用短信码登录");
                        }
                    }
                }
            },
	    });
	    return;
	    }
    }
	function checkCacctNewJs (cacct) {
    	var acctType_s = 0;
    	var pattern = /^1[3456789]\d{9}$/
    	if(pattern.test(cacct)){ //纯数字
           acctType_s = 1;
        }else if(Fai.isEmail(cacct)){
            acctType_s = 2;
        }else{
            acctType_s = 3;
        }
        return acctType_s;
    };


    //这个方法主要是根据id来对输入框进行聚焦事件，并且修改它的样式
	function checkFocus( id ){
		//var input = $('#' + id),
			//val = input.val();
		//if (id != "log-pwd-new"){
			//val = $.trim(val);
		//}
		//$('#log-form').find('input.log-input').removeClass('input1');
		//var txt = input.parent().children('.log-txt');
		//$('.log-txt').removeClass("log-txt-hover");
		//txt.addClass('log-txt-hover');
		//$('.log-line').removeClass("log-line-hover");
		//if ( id != "log-valid" ){
			//input.parent().addClass("log-line-hover");
		//}
		//if( val == '' ){
		//	txt.show();
//			if ( Fai.isIE7() ){
//				input.css("background", "transparent");
//			}
		//}else{
		//	txt.hide();
//			if ( Fai.isIE7() ){
//				input.css("background", "#fff");
//			}
		//}
//		input.addClass('input1');
	}
    //这个是显示我们密码登录的验证码，但是最好用我们的模板可能会好一点
	/*function showCode( needCode ){
		var loginMode = $(".checkLoginTab").attr("_loginmode");
		var login_line = $('#log-valid-line');
		var log_valid = $('#log-valid');
		var login_valid_img = $('#log-valid-img');
		if(loginMode == 'codeLogin'){
			login_line = $('#codeLogin-valid-line');
			log_valid = $('#codeLogin-valid');
			login_valid_img = $('#codeLogin-valid-img');
		}
		if( needCode ){
		    //显示，聚焦，刷新图片
			login_line.show();
			log_valid.val('').focus();
			login_valid_img.attr( 'src', 'validateCode.jsp?'  + parseInt(Math.random() * 1000)+'&validateCodeRegType=3');
		}else{
			login_line.hide();
		}
	}*/






	function changeValidImg(){
		showCode( true );
	}

	function useSacct() {
		if ( $('#staff-login').prop("checked") ){
			$('#rowCacct .log-txt').text("凡科网帐号");
			$('#rowSacct').show();
		} else {
			$('#rowCacct .log-txt').text("凡科网帐号/邮箱/手机号码");
			$('#rowSacct').hide();
		}
		autoFocus();
	}


	function fixRelativeJump(){
		var _host = top.location.host;
		var map = {
			"iii.cc" : "//aaa.cn",
			"www.iii.cc" : "//www.aaa.cn",
			"icoc.cc" : "//faisco.cn",
			"www.icoc.cc" : "//www.faisco.cn"
		};
		return map[_host]||"";
	}

	function reg(){
		var reg_url = 'http://www.fkw.com/reg.html?_fromsite=false';
		top.location.href = reg_url;
	}

	function showMsg(msg){

	    //有没有错误提示
	    if($('#error').css('display')!='none'){
	        $('#error').text( msg ).show();
            if($.trim(msg) == '' || msg == null){
            	$('#error').hide();
            	//减

            	$(".login-new").height($(".login-new").height()-$("#error").outerHeight(true));
            }else{
                //不变
            }
	    }else{//没有
	        $('#error').text( msg ).show();
            if($.trim(msg) == '' || msg == null){
                $('#error').hide();
                 //不变
             }else{
                 //加
                 $(".login-new").height($(".login-new").height()+$("#error").outerHeight(true));
             }
	    }




		$('#error').text( msg ).show();
		if($.trim(msg) == '' || msg == null){
			$('#error').hide();
		}
	}

	function openPassword(){
		Portal.logDog(4000118, 4);
		var cacct = $('#log-cacct-new').val();
		window.open("/api/member/sing_new_password?cacct=" + Fai.encodeUrl(cacct), "_blank");
	}

	function tipsClose(){
		Fai.removeIng2();
		Fai.removeBg();
		top.location.href = "/portal.jsp";
	}

	function bindWeChat(){
		var bindUrl = "https://i.fkw.com/bindAccountNew.jsp&state=827";
		Portal.logDog(4000027, 3);
		window.location.href = "https://open.weixin.qq.com/connect/qrconnect?appid=wx4d4e63dc215c39a6&scope=snsapi_login&redirect_uri=" + bindUrl;
	}

	function bindQQAccount(){
		Portal.logDog(4000027, 0);
		window.location.href = "https://graph.qq.com/oauth/show?which=Login&display=pc&response_type=code&client_id=101375548&redirect_uri=http%3A%2F%2Fi.fkw.com%2FbindQQAccountNew.jsp&state=82&scope=get_user_info,get_info";
	}

	function checkLoginAcct(cacct){
		var checkThrough = true;
		var reg = /[\u4e00-\u9fa5]/g;
		if (reg.test(cacct)){
			checkThrough = false;
			return checkThrough;
		} else {
			reg = /^[a-zA-Z0-9]+$/g;
			if (!reg.test(cacct)){
				checkThrough = false;
				return checkThrough;
			} else {
				reg = /^[0-9]/;
				if (reg.test(cacct)){
					checkThrough = false;
					return checkThrough;
				} else {
					if(cacct.length < 4){
						checkThrough = false;
						return checkThrough;
					}
					if(cacct.length > 30){
						checkThrough = false;
						return checkThrough;
					}
				}
			}
		}
		return checkThrough;
	}

	var login = {
		initEvent:function() {
		    //关于登录方式的选择：密码登录或者短信登录,主要是解决样式上的变化

				$(".check-type2").click(function(){
            	    $(".check-type1").css("color","#738299");
            	    $(".check-type2").css("color","#0075ff");
            	    $(".check-line1").css("display","none");
            	    $(".check-line2").css("display","inline-block");
            	    $(".box-a").css("display","none");
                    $(".box-b").css("display","block");
                    $(".login-new").css("height","499px");
                    if($("#error").css('display')!='none'){
                        $(".login-new").height(($('.login-new').height())+($('#error').outerHeight(true)));
                     }
                    $("#select-table").val("1");
                    var reg=/^1[0-9]{10}$/;
                    if(reg.test($("#log-cacct-new").val())){
                        $("#log-mobile-new").val($("#log-cacct-new").val());
                        $("#log-mobile-new").keyup();
                    }
            	});
            	$(".check-type1").click(function(){
            	    if($(".new-checkbox-div1 input[name='login-by-employee']").attr("checked")){
            	        $(".login-new").css("height","617px");
            	        if($("#error").css('display')!='none'){
                            $(".login-new").height(($('.login-new').height())+($('#error').outerHeight(true)));
                         }
            	    }else{
            	        $(".login-new").css("height","539px");
            	        if($("#error").css('display')!='none'){
                            $(".login-new").height(($('.login-new').height())+($('#error').outerHeight(true)));
                        }
            	    }

                	$(".check-type2").css("color","#738299");
                	$(".check-type1").css("color","#0075ff");
                	$(".check-line2").css("display","none");
                	$(".check-line1").css("display","block");
                	$(".box-b").css("display","none");
                    $(".box-a").css("display","block");
                    $("#select-table").val("0");
                    var reg=/^1[0-9]{10}$/;;
                    if(reg.test($("#log-mobile-new").val())){
                          $("#log-cacct-new").val($("#log-mobile-new").val());
                     }
                });



            //为页面显示的密码输入框定义事件
			$('#log-pwd-new').focus(function(){
				checkFocus( 'log-pwd-new' );
			}).blur(function(){
				checkFocus( 'log-pwd-new' );
			}).keydown(function(event){
				checkFocus( 'log-pwd-new' );
				if( event.keyCode == 13 ){
					login.loginAcct();
				}
			}).keyup(function(){
				checkFocus('log-pwd-new' );
				//$("#log-pwd").val($("#showPwd").val());
			})





            //为短信登录的手机号输入框绑定事件
			$('#log-mobile-new').focus(function(){
				checkFocus( 'log-mobile-new' );
			}).blur(function(){
				checkFocus( 'log-mobile-new' );
			}).keydown(function(event){
				checkFocus( 'log-mobile-new' );
				if( event.keyCode == 13 ){
					login.loginAcct();
				}
			}).keyup(function(){
				checkFocus( 'log-mobile-new' );
			})


            //为短信登录的短信吗输入框绑定事件
			$('#log-mobileCode-new').focus(function(){
				checkFocus( 'log-mobileCode-new' );
			}).blur(function(){
				checkFocus( 'log-mobileCode-new' );
			}).keydown(function(event){
				checkFocus( 'log-mobileCode-new' );
				if( event.keyCode == 13 ){
					login.loginAcct();
				}
			}).keyup(function(){
				checkFocus( 'log-mobileCode-new' );
			})


            //切换我们输入的密码是否可见
			/*$("#showPassword").click(function(){
				if($(this).attr("_show") == 'true'){
					$(this).attr("_show",false);
					$("#log-pwd").hide();
					$("#showPwd").show();
					$(this).addClass("log-hidePwd");
				}else{
					$(this).attr("_show",true);
					$("#log-pwd").show();
					$("#showPwd").hide();
					$(this).removeClass("log-hidePwd");
				}
			})*/
			  $(".new-password3").click(function(){
                    var tarType=$(".new-password2 input[name='new-password']").attr("type");
                    if('password'==tarType){
                        $(".new-password2 input[name='new-password']").prop("type","text");
                        $(".new-password3").css("backgroundPosition","-85px -71px");
                    }else if('text'==tarType){
                        $(".new-password2 input[name='new-password']").prop("type","password");
                        $(".new-password3").css("backgroundPosition","-87px -109px");
                    }else{
                        $(".new-password2 input[name='new-password']").prop("type","password");
                        $(".new-password3").css("backgroundPosition","-87px -109px");
                    }
                })

            //为短信登录方式的获取短信码按钮添加点击事件
			$('.new-button').click(function(){
				if($(".new-button").attr("disabled") != "disabled" && login.checkMobile()){
					login.getCodeBtnClick();
				}
			});

            //为密码登录的账号输入框绑定事件
			$('#log-cacct-new').focus(function(){
				checkFocus( 'log-cacct-new' );
			}).blur(function(){
			    checkCacctLoginByPwd($("#log-cacct-new").val());
				var acctVal = $(this).val().replace(/\s+/g, '');
				$(this).val(acctVal);
				checkFocus( 'log-cacct-new' );
			}).keydown(function(event){
				checkFocus( 'log-cacct-new' );
				if( event.keyCode == 13 ){
					var acctVal = $(this).val().replace(/\s+/g, '');
					$(this).val(acctVal);
					login.loginAcct();
				}
			}).keyup(function(){
				checkFocus( 'log-cacct-new' );
			})

            //为了密码登录的员工账号信息输入框绑定事件
			$('#log-sacct-new').focus(function(){
				checkFocus( 'log-sacct-new' );
			}).blur(function(){
				checkFocus( 'log-sacct-new' );
			}).keydown(function(event){
				checkFocus( 'log-sacct-new' );
				if( event.keyCode == 13 ){
					login.loginAcct();
				}
			}).keyup(function(){
				checkFocus( 'log-sacct-new' );
			})

            //为了密码登录的密码输入框绑定事件
			$('#log-pwd-new').focus(function(){
				checkFocus( 'log-pwd-new' );
			}).blur(function(){
				checkFocus( 'log-pwd-new' );
			}).keydown(function(event){
				checkFocus( 'log-pwd-new' );
				if( event.keyCode == 13 ){
					login.loginAcct();
				}
			}).keyup(function(){
				checkFocus( 'log-pwd-new' );
				//$("#showPwd").val($("#log-pwd").val());
			})

            //为了密码登录的验证码输入框绑定事件
			$('#log-valid').focus(function(){
				checkFocus( 'log-valid' );
			}).blur(function(){
				checkFocus( 'log-valid' );
			}).keydown(function(event){
				checkFocus( 'log-valid' );
				if( event.keyCode == 13 ){
					login.loginAcct();
				}
			}).keyup(function(){
				checkFocus( 'log-valid' );
			})


            //为了短信登录的图片验证码输入框绑定事件
			$('#codeLogin-valid').focus(function(){
				checkFocus( 'codeLogin-valid' );
			}).blur(function(){
				checkFocus( 'codeLogin-valid' );
			}).keydown(function(event){
				checkFocus( 'codeLogin-valid' );
				if( event.keyCode == 13 ){
					login.loginAcct();
				}
			}).keyup(function(){
				checkFocus( 'codeLogin-valid' );
			})


            //为图片验证码绑定刷新事件
			$('#log-valid-img, #log-refresh-btn, #codeLogin-valid-img, #codeLogin-refresh-btn').click( changeValidImg )

			//为登录按钮绑定事件
			$('#login-button-new').click(function(){
				login.loginAcct();
			});

			//按钮覆盖事件，可以省略
			//$('#login-button-new').hover(function(){
				//$(this).addClass("loginBtn-hover");
			//}, function(){
				//$(this).removeClass("loginBtn-hover");
			//});

			//注册按钮，可以省略
			//$('#reg-button, #reg-link').click( reg );
			//$('#reg-button').hover(function(){
				//$(this).addClass("regBtn-hover");
			//}, function(){
				//$(this).removeClass("regBtn-hover");
			//});


            //根据手机号输入框动态控制获取短信码的按钮状态
			$("#log-mobile-new").keyup(function(){
				if(Fai.isMobile($.trim($("#log-mobile-new").val()))){
					$(".new-button").addClass("mobileCodeBtn_ok");
					$(".new-button").removeAttr("disabled");
				}else{
					$(".new-button").removeClass("mobileCodeBtn_ok");
					$(".new-button").attr("disabled", "disabled");
				}
			})

            //控制获取短信按钮的覆盖和不覆盖的样式
			$(".mobileCodeBtn").mouseover(function(){
				if(Fai.isMobile($.trim($("#log-mobile").val())) && $(this).attr("disabled") != "disabled"){
					$(".mobileCodeBtn").addClass("mobileCodeBtn_hover");
				}else{
					$(".mobileCodeBtn").removeClass("mobileCodeBtn_hover");
				}
			}).mouseout(function(){
				$(".mobileCodeBtn").removeClass("mobileCodeBtn_hover");
			})

		},

		loginAcct:function(){
		    //需要图片验证，并且是密码登录的方式
		    var loginType=$("#select-table").val()
		    /*if ( loginType==0  && needValidateCode) {
		        //验证图形码
		        login.mImgVerify.show(true);
		        $(".m-imgVerify").find('.confirmBtn').attr("disabled",false);
		        return;
		    }*/
			var me = $('#login-button-new');
			if( me.hasClass('disabled') ){
				return;
			}

            cacct=$("#log-cacct-new").val();
            var sacct = $('#log-sacct-new').val();
            var pwd = $('#log-pwd-new').val();
            var valid = $('#log-valid').val();
            var autoLogin = $('#auto-login').prop('checked');
            var params = [];
            var staffLogin = $('#staff-login').prop("checked");
            var loginModel = $("#select-table").val();
            if("0"==loginModel){
                 loginModel="pwdLogin";
            }else if("1"==loginModel){
                  loginModel="codeLogin";
             }


			if(loginModel == 'pwdLogin'){
				if( !cacct ){
					showMsg( '请输入凡科网帐号' );
					$('#log-cacct-new').focus();
					return;
				}
				if(staffLogin){
					if(!checkLoginAcct(cacct)){
						showMsg( '请输入正确的凡科网帐号' );
						$('#log-cacct-new').focus();
						return;
					}
				}
				if( staffLogin && !sacct ){
					showMsg( '请输入员工帐号' );
					$('#log-sacct-new').focus();
					return;
				}
				if( !pwd ){
					showMsg( '请输入密码' );
					$('#log-pwd-new').focus();
					return;
				}
				//判断需不需要图片验证码
				/*if($('#log-valid-line').is(':visible')    needValidateCode && !valid ){
					login.mImgVerify.show(true);
					login.mImgVerify.setMsg( '请输入验证码' )
					$(".m-imgVerify").find('.codeVal').focus();
					return;
				}*/
			}else{
				var loginMoile = $.trim($("#log-mobile-new").val());
				var mobileCode = $.trim($('#log-mobileCode-new').val());
				if( !loginMoile ){
					showMsg( '请输入手机号码' );
					$('#log-mobile-new').focus();
					return;
				}
				if( !mobileCode ){
					showMsg( '请输入短信码' );
					$('#log-mobileCode-new').focus();
					return;
				}
			}
			params.push( 'cacct=' + Fai.encodeUrl( cacct ) );
			params.push( '&sacct=' + Fai.encodeUrl( sacct ) );
			params.push( '&pwd=' + $.md5( pwd ) );
			params.push( '&autoLogin=' + autoLogin );
			params.push( '&staffLogin=' + staffLogin );
			params.push( '&dogId=' + 0 );
			if(loginModel == 'pwdLogin'){
				params.push( '&cmd=loginCorpNew');
				params.push( '&validateCode=' + Fai.encodeUrl( valid ) );
			}else{
				params.push( '&cmd=loginCorpNewByCode');
				params.push( '&loginMoile=' + Fai.encodeUrl( loginMoile ) );
				params.push( '&mobileCode=' + Fai.encodeUrl( mobileCode ) );
				params.push( '&validateCode=' + Fai.encodeUrl( $('#codeLogin-valid').val() ) );
			}
			if($("#select-table").val()==0){
			    if(!needValidateCode){
			        me.html('正在登录...');
			    }else{
			        $(".m-imgVerify").find('.confirmBtn').html("正在登录...")
			    }
			}else{
			    me.addClass( 'disabled' ).html('正在登录...');
			}
			showMsg('');
			$.ajax({
				type: 'post',
				url: '/ajax/login_h.jsp?dogSrc=3',
				data: params.join(''),
				error: function(){
				    if($("#select-table").val()==0){//密码登录的时候执行
                        login.mImgVerify.close();
                        me.removeClass( 'disabled' ).html('登&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;录');
				    }
					showMsg( '服务繁忙，请稍候重试' );
				},
				success: function(result){
					var data = $.parseJSON( result );

					if( data ){
						if( data.success ){
						    if($("#select-table").val()==0){//密码登录的时候执行
                                if(typeof($(".m-imgVerify").css('display'))!='undefined'){
                                    login.mImgVerify.close();
                                   }
                             }
						    //在这里进行处理，记录我们的新页面各个操作记录
                             if($("#select-table").val()==0){
                              //账号登录
                                if($(".new-checkbox-div1 input[name='login-by-employee']").prop("checked")==true){
                                    Portal.logDog(4000118,22);
                                }else{
                                    Portal.logDog(4000118,21);
                                }
                              }else{
                                 //短信码登录
                                 Portal.logDog(4000118,23);
                            }


							// ## START success ##
							// 写cookie：登录后复制网站
							var cloneAid = 0;
							var templateId = -1;
							var cookieDomain = 'fkw.com';
							var fromUrl = '';
							var jump = 0;
							var days = data.days;
							//是否是内部帐号
							var isInternalCorp = data.isInternalCorp;
							// 写cookie：进网站后跳转
							var jumpSite = false;
							if( cloneAid != 0 ){
								$.cookie( '_regCloneAid', cloneAid, {domain: cookieDomain} );
								if( templateId != 0 ){
									$.cookie( '_regTemplateId', templateId, {domain: cookieDomain} );
								}
								jumpSite = true;
							}
							var jumpUrl = "";
							if( jump != 0 ){
								jumpUrl = '/jump.jsp?t=' + jump;
							}else if(data.callBack){
								jumpUrl = data.callBackUrl;
							} else if (jumpSite) {
								jumpUrl = data.siteUrl;
							} else {
								if (fromUrl) {
									jumpUrl = fromUrl;
								} else {
									//jumpUrl = fixRelativeJump() + '/portal.jsp';
									jumpUrl = '/portal.jsp';
								}
							}

							//用户注册7天后在所有登录入口每次登陆均判断密码是否符合安全强度要求
							//（密码由6-20个字符组成，须同时包含字母、数字和特殊符号其中两种组合），如果不符合
							if(data.aid == 1 && (/^(fanke)/.test(pwd) || /^(faisco)/.test(pwd))){
								jumpUrl = '/portal.jsp#appId=setPwd';
								$.cookie( 'faiIng', '0', { expires: 1, path: '/' } );
							}else if(days > 7){
								var modes = 0;
								//数字
								if ( /\d/.test(pwd) ) {
									modes++;
								}
								//字母
								if ( (/[a-z]/.test(pwd)) || (/[A-Z]/.test(pwd)) ) {
									modes++;
								}
								//特殊符号
								if ( /\W/.test(pwd) || /[_]/.test(pwd) ) {
									modes++;
								}
								if(modes < 2){
									//内部帐号
									if(isInternalCorp == 'true'){
										jumpUrl = '/portal.jsp#appId=setPwd';
										$.cookie( 'faiIng', '0', { expires: 1, path: '/' } );
									}else{
										$.cookie( 'faiIng', '1', { expires: 1, path: '/' } );
									}
								}else{
									$.cookie( 'faiIng', '0', { expires: 1, path: '/' } );
								}

							}else{
								$.cookie( 'faiIng', '0', { expires: 1, path: '/' } );
							}
							$.cookie("orderTipsCookie","true",{expires: 7 ,path:'/' });
							$.cookie("couponTipsCookie","true",{expires: 7 ,path:'/' });
							$.cookie("serviceTipsCookie","true",{expires: 7 ,path:'/' });
							$.cookie('_hasClosePlatinumAd_',"false",{expires: 1, path: '/',domain:'fkw.com'});//互动portal index上的小广告窗口
							$.cookie('_hasClosePlatinum_',"false",{expires: 1, path: '/',domain:'fkw.com'});//互动portal myactive上的banner
							$.cookie("_hasCloseFlyerAd_","false",{expires: 1, path: '/',domain:'fkw.com'});//hdportal 引导开通传单
							$.cookie("_hasCloseHdGG_","false",{expires: 1, path: '/',domain:'fkw.com'});//flyer 引导开通传单
							$.cookie("faiscoAd",true,{expires: 1, path: '/',domain:'fkw.com'});//site左下角广告是否显示
							$.cookie("_whereToPortal_","login",{expires: 1, path: '/',domain:'fkw.com'});//记录何处到商务平台
							$.cookie('hasShowBeianWindow', null, {path:'/service'});	//清除siteRecord.jsp下面的备案提示弹窗cookie
							$.cookie('hasShowDomainBeianWindow', null);
							$.cookie('hasShowBeianSmsTips', null, {path:'/service'});

							//往工单系统存储cookie用于处理跨域请求
							top.location.href = jumpUrl;
							// ## END success ##
						}else{
							// ## START error ##
							if( data.active ){
								top.location.href = '//i.fkw.com/reAct.jsp?cacct=' + cacct;
								return;
							}

							if( data.msg ){
								msg = data.msg;
							}else{
								msg = '系统错误';
							}

							if(typeof(data.verify) != "undefined"){
							    $('#error').text("").show();
							    $('#error').html('手机未验证，请<a href="http://www.fkw.com/reg.html" target="_blank" style="color:#3497db">注册</a>');
							}else{
							    if(data.rt!=-201){
								    showMsg( msg );
								}
							}
							me.removeClass( 'disabled' ).html('登&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;录');
                            //图片验证码错误(只在我们的密码登录执行)
                            if($("#select-table").val()==0){
                                $(".m-imgVerify").find('.confirmBtn').html("确定");
                                me.html('登&nbsp;&nbsp;&nbsp;&nbsp;录');
                                login.mImgVerify.close();
                                if(data.rt==-201){//是否是验证码错误
                                    login.mImgVerify.show(true);
                                    login.mImgVerify.setMsg(data.msg);
                                    needValidateCode=data.needValidateCode;
                                    $(".m-imgVerify").find('.codeVal').focus();
                                    return;
                                }else{
                                    needValidateCode=data.needValidateCode;
                                    showMsg(data.msg);
                                    return;
                                }
                            }
			        // ## END error ##
						}
					}else{
						showMsg( '连接超时，请重试' );
						me.removeClass( 'disabled' ).html('登&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;录');
					}
				}
			})
		},
		checkMobile:function(){
			var $mobile = $('#log-mobile-new'),
				msg = '';
			var mobile = $.trim($mobile.val());
			if(!mobile){
				msg = '请输入手机号码';
			}else if(!Fai.isMobile(mobile)){
				msg = '请输入正确的11位手机号码';
			}

			if(msg){
				showMsg( msg);
				return false;
			}else{
				return true;
			}
		},
		getCodeBtnClick:function(){
			var $btn = $('.new-button');
			var timeCtrl = $btn[0]._timeCtrl;
			if(!timeCtrl){
				timeCtrl = {
					timer: null,
					second: 60,
					clickCnt: 0
				};
				$btn[0]._timeCtrl = timeCtrl;
			}
			if(timeCtrl.timer){
				return false;
			}
			if($(".new-button").attr("disabled") == "disabled"){
				return false;
			}
			$.ajax({
				type:"post",
				url:"/ajax/login_h.jsp?cmd=checkMobileVerify&mobile="+$.trim($("#log-mobile-new").val()),
				success: function(result){
					var data = $.parseJSON( result );
					if(typeof(data.verify) != "undefined"){
						$btn.attr('disabled', 'disabled');
						//这里应该是解除可以点击的样式
						$btn.removeClass('mobileCodeBtn_ok');
						$('#error').text("").show();
						$('#error').html('手机未验证，请<a href="http://www.fkw.com/reg.html" target="_blank" style="color:#3497db">注册</a>');
					}else{
					    //根据我们的参数判断我们是否需要短信登录的图片验证码
						if(true && false){//1.是否防止恶意注册2.是否需要图形验证码判断
							login.mImgVerify.show(false);
						}else{
							$btn.attr('disabled', 'disabled');
							login.mImgVerify.sendValidateCode(null, null, function(msg){
								showMsg( msg);
								$(".new-button").removeClass('mobileCodeBtn_ok');
								//$btn.removeAttr('disabled');
							});
						}
					}
				}
			});


		},
		 /* 图形验证码 */
		mImgVerify : {//image
			templateId : '#t-imgVerify',//模板
			$dom : null,
			validateCodeRegType: 3,	//默认为建站 =====(用于判断显验证码的类型)=====
			show: function(isMailAcct_mobile){
				showMsg('');
				$($(this.templateId).html()).appendTo($('body'));
				this.$dom = $(".m-imgVerify");
				login.mImgVerify.refresh();
				Fai.bg();
				$(".m-imgVerify").find('.close').click(function(){
					login.mImgVerify.close();
				});
				$(".m-imgVerify").find('.codeImg, .refreshBtn').click(login.mImgVerify.refresh);
				$(".m-imgVerify").find('.confirmBtn').click(function(){
                    //短信登录的时候的执行方法
                    if($("#select-table").val()!=0){
                        var $this = $(this);
                        if(login.mImgVerify.checkCode()){
                               var code = $.trim($(".m-imgVerify").find('.codeVal').val());
                               $this.attr('disabled', 'disabled');
                               login.mImgVerify.sendValidateCode(code, null, function(){
                                    $this.removeAttr('disabled');
                               });
                          }
                    }else{//密码登录;
                        if(login.mImgVerify.checkCode()){
                             $("#log-valid").val($.trim($(".m-imgVerify").find('.codeVal').val()));
                             $(".m-imgVerify").find('.codeVal').attr("disabled",false);
                             login.loginAcct();
                         }
    		         }
				});
				this.$dom.find('.codeVal').keydown(function(event){
					if(event.keyCode == 13 || event.which == 13){
				    $(".m-imgVerify").find('.confirmBtn').click();
				    //IE9需要阻止enter键触发“获取验证码”按钮的点击，避免再次弹窗。（这里转移了focus都没用，很奇葩）
				    event.preventDefault();
				}
				}).focus();
				//IE9需要异步触发focus()
			},
			close: function(){
				$(".m-imgVerify").remove();
				Fai.removeBg();
			},
			setMsg: function(msg){
				var $msg = $(".m-imgVerify").find('.msg').html(msg);
				if(msg){
					$msg.show();
				}else{
					$msg.hide();
				}
			},
			refresh:function(){
				$(".m-imgVerify").find('.codeImg').attr('src', 'validateCode.jsp?' + parseInt(Math.random() * 1000) + '&validateCodeRegType=3');
				$(".m-imgVerify").find('.codeVal').focus();
			},
			checkCode:function(){
				var code = $.trim($(".m-imgVerify").find('.codeVal').val());
				var msg = null;
				if(!code){
					msg = '请输入图片验证码';
				}else if(code.length != 4){
					msg = '请输入正确的图片验证码';
				}
				if(msg){
					login.mImgVerify.setMsg(msg);
					$(".m-imgVerify").find('.codeVal').focus();
					return false;
				}else{
					return true;
				}
			},
			sendValidateCode:function( imgCode, callbackSuc, callbackErr){
				//isMailAcct_mobile : false 默认， true 邮箱注册用户手机号验证
				var $btn = $('.new-button');
				var timeCtrl = $btn[0]._timeCtrl;
				var acctType_s = (Fai.isMobile(cacct) ? 1 : 2);
				var cacct =  $.trim($("#log-mobile-new").val());
				var $codeInput = $('#log-mobileCode-new');
				if(!timeCtrl || timeCtrl.timer){
					return false;
				}
				var validateCode = imgCode;
				if(validateCode){
					var encrypt = new JSEncrypt();
					encrypt.setPublicKey(faiEncrypt_key);
					validateCode = encrypt.encrypt(validateCode);
				}
				var isMailAcct_mobile = false;
				var cacctCode = '';
				var encrypt1 = new JSEncrypt();
				
				encrypt1 = new JSEncrypt1();
				
				encrypt1.setPublicKey(faiEncrypt_key);
				cacctCode = encrypt1.encrypt(cacct);
				$.ajax({
					type:"post",
					url:"/ajax/reg_h.jsp?cmd=sendValidateCode",
					data: {
						cacct: cacct,
						acctType: acctType_s,
						isResend: timeCtrl.clickCnt > 0,
						validateCode: validateCode || '',
						isNewSms: true,
						cacctCode: cacctCode,
						isMailAcct: isMailAcct_mobile
					},
					error: function(){
						if(typeof callbackErr == 'function'){
						callbackErr('系统繁忙');
					}
					},
					success: function(result){
					    if($("#select_table")==0){
					        //只需要验证图形验证码，成功的话就隐藏起来然后直接登录到界面

					    }else{
                                var result = jQuery.parseJSON(result);
                                if(result.success){
                                //operatePopupVc('false');
                                $btn.attr('disabled', 'disabled');
                                $btn.removeClass('mobileCodeBtn_ok');
                                clearInterval(timeCtrl.timer);
                                timeCtrl.clickCnt++;
                                timeCtrl.second = 60;
                                timeCtrl.timer = setInterval(function(){
                                    if(timeCtrl.second > 0){
                                        $btn.html('已发送(' + timeCtrl.second + ')');
                                        timeCtrl.second--;
                                    }else{
                                        $btn.html('重新获取').removeAttr('disabled');
                                        $btn.addClass('mobileCodeBtn_ok');
                                        clearInterval(timeCtrl.timer);
                                        timeCtrl.timer = null;
                                    }
                                }, 1000);

                                $btn.closest('.u-input').find('.msg').removeClass('z-err').show();
                                var cacctStr = cacct;
                                if(validateCode){
                                    login.mImgVerify.close();
                                }
                                $codeInput.focus();
                                if(typeof callbackSuc == 'function'){
                                    callbackSuc();
                                }
                                if($("#codeLogin-valid-line").css("display") == "block"){
                                    $("#codeLogin-refresh-btn").click();
                                }
                                }else{
                                var msg = result.msg;
                                if(validateCode){
                                    if(result.rt == -401){
                                        msg = '图片验证码错误，请重新输入';
                                    }
                                    login.mImgVerify.setMsg(msg);
                                    login.mImgVerify.refresh();
                                }else{
                                    if(result.rt == -401){
                                        login.mImgVerify.show(isMailAcct_mobile);
                                    }else{
                                        $btn.closest('.u-input').find('.msg').addClass('z-err').show();
                                    }
                                }
                                if(typeof callbackErr == 'function'){
                                    callbackErr(msg);
                                }
                                }
                            }
                            }


				    });






			 },
		}
	}
	
	;(function($, undefined){
		//如果是mjzpro10过来，用cookie记录一下。用于portal.jsp登录后打log by jser
		if(false){
			$.cookie("isFromMJZPro10", true);
		}
	}(jQuery));


</script>
